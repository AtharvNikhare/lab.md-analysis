from pylab import plot, show, title, xlabel, ylabel, subplot, legend,subplots_adjust,sin, pi,fft,arange,savefig

#data gathered from each of the models
#=====================================================================================
time = [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 3.0, 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5.0, 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6.0, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 7.0, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8.0, 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9, 9.0, 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7, 9.8, 9.9]


nextGen_ke = [0.07000254622302354, 0.1645894380612178, 0.27660479681119, 0.3831891158702528, 0.46265128891904095, 0.4988224478149955, 0.484282677637065, 0.4220939143705823, 0.324826227056369, 0.21238210160055623, 0.10753307431696182, 0.03171225306158809, 0.00036485384553017804, 0.01984723738010362, 0.08620078336811995, 0.18581087600301716, 0.2984742409533657, 0.4012589498327187, 0.47333872914874725, 0.49984941926043475, 0.4754410258140971, 0.40505250296616924, 0.30309399903229917, 0.19031661766255145, 0.08970659540589093, 0.021705993695454336, 0.00015378225759215348, 0.029452881988014903, 0.10363047999610743, 0.20755907520431635, 0.32010558070022227, 0.41835378855927624, 0.482340151826975, 0.4990354706623399, 0.46495949993943664, 0.38707445253531836, 0.28125127648450593, 0.16902857919619296, 0.07330611760396587, 0.01355886845103626, 0.0019202005912794648, 0.04075361623935051, 0.12220087275190343, 0.22962145349923654, 0.34116796174523367, 0.43406572636013663, 0.48943061001611105, 0.49604609012787165, 0.4525341000594822, 0.3676469820746006, 0.25874430504832063, 0.14809130061541026, 0.058138455128786924, 0.007226776987802056, 0.005700810410491078, 0.05391273000801782, 0.14198325603399434, 0.25205847407752896, 0.3616725666198682, 0.44849410622973573, 0.4949037849178419, 0.4913611166922405, 0.438692367978234, 0.3474943335009051, 0.23640847878427387, 0.12811648355875352, 0.044575598869187626, 0.0028570043283075103, 0.011438096595498104, 0.06854576177055285, 0.16255153343131126, 0.2743430405230667, 0.3810580184865327, 0.4610208998230856, 0.4979914573850953, 0.4843653762414319, 0.4229830786277573, 0.3263340163194889, 0.21410027243200197, 0.10905127532642821, 0.03265492857433805, 0.00048198083016468116, 0.019018843423391902, 0.08452332999600706, 0.18365262748473657, 0.2962073772967555, 0.39927146840332806, 0.4718395141766884, 0.4992115389738788, 0.4757487219649736, 0.40625927458238537, 0.3048752377000654, 0.19224809815246757, 0.09132044038559209, 0.022601463549737813, 0.00008737666552907911, 0.028389598931406523, 0.10175441190680297, 0.2051895101691712, 0.317662435410978]
nextGen_pe = [0.4406384257940599, 0.34372553060074695, 0.22894109400511953, 0.11973482783284028, 0.038337240549080054, 0.0012445720479203892, 0.016110683793979508, 0.07985882555489043, 0.17948655912897182, 0.2947500019281901, 0.40211203423262676, 0.4797381157331526, 0.5118801951312091, 0.49188798868088357, 0.4239199651337455, 0.3218044900624162, 0.2063036141589092, 0.10093415641315717, 0.027156600082289817, 0.0000114149159569088, 0.025023168837290388, 0.09708508894840095, 0.20155593265763772, 0.3170535088273252, 0.42012374530636665, 0.4898372180342503, 0.5119570914871585, 0.4819402713643339, 0.4059201495934528, 0.2994675259795909, 0.18410394576201528, 0.08344938971199811, 0.017884657268762982, 0.0008044738677992491, 0.035699359515473095, 0.11548911072162271, 0.2239402297402049, 0.33892521327488767, 0.43704927844140373, 0.49831737816391497, 0.5101929469233935, 0.4702917683754859, 0.38685454476522496, 0.27674643928748965, 0.1624346907050378, 0.06719854728914898, 0.010418214924368119, 0.003644866082563869, 0.048266439212352186, 0.13518404392592887, 0.24672981358692114, 0.36017691996265144, 0.45231983248933405, 0.5045055763489015, 0.5061114377660769, 0.4567981525507858, 0.3665486694640063, 0.25372073825274954, 0.141440934487147, 0.05246906669392759, 0.004924682664164681, 0.008520849406334907, 0.06252783895349667, 0.15589080497840913, 0.26964432520842907, 0.38068229226945194, 0.46627702133400506, 0.5089774473912567, 0.5001517947469947, 0.44166439150644665, 0.34527534894551737, 0.2307728215658611, 0.12133636172501072, 0.03934268995281487, 0.0014566897757473107, 0.01536286689224342, 0.07819712637663345, 0.17725352888825485, 0.29229646939549214, 0.39999143388841363, 0.47821403429432197, 0.511179347684465, 0.4922353750227981, 0.4250444371692308, 0.3234934793841515, 0.20814066382685015, 0.10251160152990879, 0.028085027026503173, 0.000040953243296559805, 0.024060874415365863, 0.09525852067399088, 0.19913839448798543, 0.3145015591091149, 0.4179152387376317, 0.4882529892860643, 0.5113013962557145, 0.4823573044390739, 0.4071415150022628, 0.30113623865873906, 0.18585592137548845]
nextGen_te = [0.5106409720170835, 0.5083149686619648, 0.5055458908163095, 0.502923943703093, 0.500988529468121, 0.5000670198629159, 0.5003933614310445, 0.5019527399254727, 0.5043127861853408, 0.5071321035287464, 0.5096451085495886, 0.5114503687947407, 0.5122450489767393, 0.5117352260609872, 0.5101207485018655, 0.5076153660654333, 0.5047778551122749, 0.5021931062458759, 0.500495329231037, 0.49986083417639166, 0.5004641946513875, 0.5021375919145702, 0.5046499316899369, 0.5073701264898767, 0.5098303407122575, 0.5115432117297046, 0.5121108737447506, 0.5113931533523488, 0.5095506295895602, 0.5070266011839073, 0.5042095264622375, 0.5018031782712744, 0.500224809095738, 0.49983994453013914, 0.5006588594549097, 0.5025635632569411, 0.5051915062247108, 0.5079537924710806, 0.5103553960453696, 0.5118762466149512, 0.512113147514673, 0.5110453846148364, 0.5090554175171284, 0.5063678927867262, 0.5036026524502715, 0.5012642736492856, 0.49984882494047916, 0.4996909562104355, 0.5008005392718344, 0.5028310260005295, 0.5054741186352418, 0.5082682205780618, 0.510458287618121, 0.5117323533367035, 0.511812248176568, 0.5107108825588036, 0.5085319254980006, 0.5057792123302784, 0.5031135011070151, 0.5009631729236633, 0.4998284675820066, 0.4998819660985754, 0.5012202069317306, 0.5033851384793142, 0.5060528039927029, 0.5087987758282054, 0.5108526202031927, 0.5118344517195642, 0.5115898913424928, 0.5102101532769995, 0.5078268823768286, 0.5051158620889278, 0.5023943802115434, 0.5003635897759005, 0.4994481471608426, 0.4997282431336753, 0.5011802050043908, 0.5035875452077437, 0.5063967418274942, 0.5090427092148418, 0.51086896286866, 0.5116613285146298, 0.51125421844619, 0.5095677671652379, 0.5071461068688881, 0.5043480411236057, 0.5017830699332368, 0.4999245412031916, 0.4992524922171754, 0.49980959638033945, 0.5015177952563763, 0.5040136321880508, 0.5067496572615825, 0.5092356791232238, 0.5108544528358021, 0.5113887729212435, 0.5107469033704803, 0.5088959269090658, 0.5063257488279103, 0.5035183567864665]


classic_ke = [0.05007586628198624,0.12177816778421402,0.19468308985233307,0.2419224977493286,0.24608737230300903,0.20564326643943787,0.13549523055553436,0.06149476394057274,0.010913258418440819,0.002391782123595476,0.03907083347439766,0.10743281990289688,0.1822841763496399,0.23604008555412292,0.24888986349105835,0.21609757840633392,0.14974787831306458,0.0742928683757782,0.017540792003273964,4.072894516866654E-4,0.02920684590935707,0.09332551062107086,0.1691327691078186,0.22869066894054413,0.25005027651786804,0.22534027695655823,0.16366739571094513,0.08775986731052399,0.025591781362891197,7.413986895699054E-5,0.020611168816685677,0.0796341821551323,0.15539120137691498,0.21996358036994934,0.2495545595884323,0.2332586795091629,0.17708106338977814,0.10172487795352936,0.0349617674946785,0.0013968152925372124,0.013400236144661903,0.06654822081327438,0.14125336706638336,0.20998375117778778,0.247409850358963,0.2397392839193344,0.1897992640733719,0.11599428206682205,0.04552353173494339,0.004357671830803156,0.007667828816920519,0.054234083741903305,0.12689509987831116,0.19887307286262512,0.24364213645458221,0.24470339715480804,0.20166532695293427,0.1303885579109192,0.057141151279211044,0.00891781598329544,0.0034910182002931833,0.04286078363656998,0.11251756548881531,0.1867898851633072,0.23830558359622955,0.24807965755462646,0.21251049637794495,0.1447066068649292,0.0696556493639946,0.01501610316336155,9.245328255929053E-4,0.03257422894239426,0.09830108284950256,0.1738826334476471,0.2314649373292923,0.24982720613479614,0.22220203280448914,0.15876977145671844,0.08290731906890869,0.022572992369532585,2.648450163178495E-6,0.02351449243724346,0.08444333076477051,0.16033421456813812,0.22321835160255432,0.24992084503173828,0.23060141503810883,0.17238017916679382,0.09671339392662048,0.03148641064763069,7.374894339591265E-4,0.015798764303326607,0.07111957669258118,0.14631229639053345,0.21366620063781738,0.24835947155952454,0.23760637640953064,0.1853693276643753,0.1108991876244545,0.04164101183414459]
classic_pe = [0.2047487050294876,0.13128338754177094,0.056585926562547684,0.008185077458620071,0.003917862195521593,0.04535641148686409,0.11722919344902039,0.1930491179227829,0.24487431347370148,0.25360530614852905,0.21602439880371094,0.1459815800189972,0.06928984075784683,0.014212200418114662,0.0010464278748258948,0.03464492782950401,0.10262597352266312,0.1799362450838089,0.23808375000953674,0.2556385397911072,0.22613084316253662,0.16043563187122345,0.08276446163654327,0.021742211654782295,-1.4249139348976314E-4,0.025175100192427635,0.08836435526609421,0.16613823175430298,0.2298348844051361,0.2559799551963806,0.23493795096874237,0.17446370422840118,0.09684403985738754,0.03068399988114834,3.654191386885941E-4,0.017061900347471237,0.07462073117494583,0.15182973444461823,0.22023442387580872,0.2546246647834778,0.24232611060142517,0.1878713220357895,0.1113293468952179,0.040909066796302795,0.002562815323472023,0.010422056540846825,0.06158997863531113,0.13720960915088654,0.2094130516052246,0.2515910863876343,0.24819953739643097,0.20048832893371582,0.1260407716035843,0.052293065935373306,0.006423233076930046,0.005335814785212278,0.049432020634412766,0.12246128171682358,0.19750969111919403,0.24691875278949738,0.2524789869785309,0.21214118599891663,0.14077168703079224,0.06467320770025253,0.011890910565853119,0.0018765843706205487,0.03832034394145012,0.10779133439064026,0.18468758463859558,0.2406705915927887,0.25510865449905396,0.22268074750900269,0.15533782541751862,0.07789795845746994,0.01889985427260399,8.605144830653444E-5,0.028390388935804367,0.09338224679231644,0.17110998928546906,0.2329278141260147,0.2560531198978424,0.2319631725549698,0.16953620314598083,0.09177933633327484,0.027349084615707397,-9.899250471789856E-6,0.019784606993198395,0.07943735271692276,0.15696455538272858,0.2237953096628189,0.25530028343200684,0.23986868560314178,0.18318766355514526,0.10614617168903351,0.03713621944189072,0.0015898874262347817,0.01260730717331171,0.0661286860704422,0.14242985844612122,0.21339094638824463]
classic_te = [0.25578758120536804,0.25482457876205444,0.25306156277656555,0.25126901268959045,0.2501075863838196,0.25000524520874023,0.25099968910217285,0.25272440910339355,0.25454390048980713,0.25599709153175354,0.2550952434539795,0.2534143924713135,0.25157400965690613,0.25025230646133423,0.2499362975358963,0.25074249505996704,0.2523738443851471,0.2542291283607483,0.25562453269958496,0.2560458183288574,0.2553376853466034,0.2537611424922943,0.2518972158432007,0.2504328787326813,0.24990777671337128,0.2505153715610504,0.25203174352645874,0.25389808416366577,0.25542664527893066,0.2560541033744812,0.2555491328239441,0.2540978789329529,0.2522352337837219,0.25064757466316223,0.24991998076438904,0.25032058358192444,0.25170180201530457,0.2535546123981476,0.2551961839199066,0.25602149963378906,0.25572633743286133,0.2544195353984833,0.25258269906044006,0.2508928179740906,0.24997267127037048,0.2501613199710846,0.2513892352581024,0.2532038986682892,0.2549365758895874,0.2559487521648407,0.2558673620223999,0.2547224164009094,0.25293588638305664,0.25116613507270813,0.2500653564929962,0.2500392198562622,0.25109735131263733,0.25284984707832336,0.2546508312225342,0.2558365762233734,0.2559700012207031,0.255001962184906,0.25328925251960754,0.2514630854129791,0.2501964867115021,0.24995625019073486,0.25083082914352417,0.25249794125556946,0.2543432414531708,0.2556867003440857,0.25603318214416504,0.25525498390197754,0.2536389231681824,0.25178059935569763,0.2503647804260254,0.24991324543952942,0.2505924105644226,0.2521520256996155,0.25401729345321655,0.25550082325935364,0.2560557723045349,0.2554776668548584,0.25397953391075134,0.25211355090141296,0.2505674362182617,0.24991095066070557,0.2503860294818878,0.251817524433136,0.25367796421051025,0.2552817165851593,0.25603777170181274,0.25566744804382324,0.25430724024772644,0.25245845317840576,0.2508024275302887,0.2499493658542633,0.2502136826515198,0.2514980137348175,0.2533290386199951,0.2550319731235504]

#data is ordered ke......pe......te
classic_data = open('/home/jackson/lab/lab.md-analysis/radial-bond_tests/data/classic/different_ellements/data.txt','rb')
data = classic_data.readlines()
data.pop(0)
print(data)
classic_ke = []
classic_pe = []
classic_te = []
for i in data:
	row = eval(i)
	classic_ke.append(row[0])
	classic_pe.append(row[1])
	classic_te.append(row[2])



#data is ordered ke......pe......te
classic_data = open('/home/jackson/lab/lab.md-analysis/radial-bond_tests/data/next_gen/different_ellements/data.txt','rb')
data = classic_data.readlines()
data.pop(0)
classic_ke = []
classic_pe = []
classic_te = []
for i in data:
	row = eval(i)
	nextGen_ke.append(row[0])
	nextGen_pe.append(row[1])
	nextGen_te.append(row[2])

#=====================================================================================

def plotSpectrum(data,sample_rate,color,label):
	data_length = len(data) # length of the signal
	data_len_array = arange(data_length)
	time = data_length/sample_rate
	frq = data_len_array/time # two sides frequency range
	frq = frq[range(data_length/2)] # one side frequency range
	dataFreq = fft(data)/data_length # compute the forier transform and normalize the data
	dataFreq = dataFreq[range(data_length/2)]
	plot(frq[1:-1],abs(dataFreq)[1:-1],color,label = label) # plots the forier transform
	xlabel('Freq (THz)')
	ylabel('energy in the waves(eV)')

def graph(time,data,color,label):
	plot(time,data,color,label = label)
	xlabel('Time (ps)')
	ylabel('energy (eV)')

sample_rate = 10.0;  # sampling rate per pico second


#top plot
subplot(2,1,1)
title('comparing the energy of one radial bond in the java and javascript MW')
plot(0,0,'white',label = 'next gen')
graph(time,nextGen_ke,'r','ke')
graph(time,nextGen_pe,'orange','pe')
graph(time,nextGen_te,'yellow','te')

plot(0,0,'white',label = 'classic')
graph(time,classic_ke,'g','ke')
graph(time,classic_pe,'blue',' pe')
graph(time,classic_te,'purple','te')


legend(bbox_to_anchor=(1.01, .65),ncol = 2, loc=2, borderaxespad=0.)


#bottom plot
subplot(2,1,2)
title('frequency analysis')
plot(0,0,'white',label = 'next gen')
plotSpectrum(nextGen_ke,sample_rate,'ro','ke')
plotSpectrum(nextGen_pe,sample_rate,'orange','pe')
plotSpectrum(nextGen_te,sample_rate,'yellow','te')

plot(0,0,'white',label = 'classic')
plotSpectrum(classic_ke ,sample_rate,'go','ke')
plotSpectrum(classic_pe ,sample_rate,'blue','pe')
plotSpectrum(classic_te ,sample_rate,'purple','te')
legend(bbox_to_anchor=(1.01, .65), loc=2, ncol = 2,borderaxespad=0.)


#adjust the plots for optimal display
subplots_adjust(right = .78, hspace = .35)

#save image of graph
#savefig('figures/one_radial_bond_analysis.png',dpi = 300,facecolor = '.75')

#display the plots
show()